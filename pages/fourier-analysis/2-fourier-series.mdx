import SignalPlotter from '../../components/SignalPlotter.tsx'
import Harmonics from '../../components/Harmonics.tsx'
import ComplexExpoentialsSum from '../../components/ComplexExponentialsSum.tsx'
import QuestionAnswer, { Answer } from '../../components/QuestionAnswer.tsx'
import { Callout } from 'nextra-theme-docs'
import ComplexConjugates from '../../components/ComplexConjugates.tsx'

# Fourier-Reihen

## Motivation der Fourier-Reihen

Im Abschnitt [_Periodische Funktionen_](./1-periodic-functions) wurde die Frage gestellt, inwiefern jede periodische Funktion $f(t)$ in der Schreibweise:

$$
f(t) = \sum_{k=-n}^n c_k e^{2 \pi i k f_0 t } \qquad \text{ (dies ist noch keine Fourier-Reihe)}
$$

ausgedr√ºckt werden kann. Diese Frage soll in diesem Abschnitt beantwortet werden. Zudem soll ein Verfahren ermittelt werden, mit welchem man die Koeffizienten $c_k$ bestimmen kann, wenn eine bestimmte periodische Funktion $f(t)$ bekannt ist.

Warum sollte man jedoch √ºberhaupt versuchen eine bekannte periodische Funktion $f(t)$ mithilfe einer Summe der obigen Form darzustellen?

### Rechteckssignal

Man kann zum Beispiel das Signal, welches der Funktion $f(t) = \begin{cases} 1 \text{ wenn } \lfloor t \rfloor \text{ gerade} \\ 0 \text{ wenn } \lfloor t \rfloor \text{ ungerade} \end{cases}$ entspricht, betrachten:

<Callout>
  $\lfloor x \rfloor$ bedeutet, dass $x$ abgerundet wird. Also z.B. $\lfloor 0.8
  \rfloor = 0$ oder $\lfloor 5.99 \rfloor = 5$
</Callout>

<SignalPlotter f={(x) => 1 - Math.abs(Math.floor(x) % 2)} />

<Callout type="info" emoji="üìö">
  Nachlesen zur Rechtecksschwingung: [Wikipedia:
  Rechtecksschwingung](https://de.wikipedia.org/wiki/Rechteckschwingung)
</Callout>

Dieses Signal ist beispielsweise relevant in der Informations√ºbertragung (Kodierung von $1$ und $0$ mit verschiedenen Spannungen).

Da es jedoch nicht m√∂glich einen Spannungsanstieg innerhalb von $0s$ hervorzurufen, ist es relevant, eine andere Ann√§herung f√ºr diese Funktion zu finden, was z.B. durch die **Fourier-Reihe** erreicht werden kann.
Bis jetzt ist jedoch noch nicht klar, ob es √ºberhaupt m√∂glich ist eine solche Funktion mit einer Summe von komplexen Exponentialfunktionen zu modellieren.

---

Im Folgenden wird die **Grundfrequenz** mit einer Periodendauer $f_0 = \frac{1}{T}$ ausgedr√ºckt, um den Funktionsnamen $f(t)$ und das $f$ der Frequenz nicht zu verwechseln:

$$
f(t) = \sum_{k=-n}^n c_k e^{\frac{2 \pi i k}{T} t }
$$

$T$ beschreibt dabei die Zeit, welche f√ºr eine Periode ben√∂tigt wird: $f(t) = f(t+T)$

## Komplexe Funktionen

Um sich der obigen Frage anzun√§hern, lassen sich die Koeffizienten $c_k$ nochmal etwas genauer betrachten.

### Darstellung von Funktionswerten

Um mehr Intuition √ºber die Modellierung eines periodischen Vorgangs durch die Summe

$$
f(t) = \sum_{k=-n}^n c_k e^{\frac{2 \pi i k}{T} t }
$$

zu bekommen, lassen sich die Funktionswerte auf einer [komplexen Ebene](../appendix/complex-numbers/1-complex-plane) betrachten.

<QuestionAnswer>
  <>
    Was w√ºrde f√ºr $f(t)$ gelten, wenn nur $c_1 = 0.5$ gesetzt wird und die
    Eigenschaft der **konjugierten komplexen Koeffizienten** beachtet wird ?
  </>
  <Answer correct={true}>$f(t) = 0.5  e^{\frac{2 \pi i }{T} t } + 0.5 e^{\frac{-2 \pi i}{T} t }$</Answer>
  <Answer>$f(t) = 0.5 e^{\frac{2 \pi i }{T} t }$</Answer>
  <Answer>$f(t) =  e^{\frac{2 \pi i }{T} t }$</Answer>
</QuestionAnswer>

Wenn man die Ergebnisse von $f(t)$ auf der komplexen Ebene betrachtet, wird deutlich, dass sich die Ergebnisse lediglich auf der _Realteil-Achse_ befinden:

<ComplexExpoentialsSum
  ak={[
    [0.5, 0, 1],
    [0.5, 0, -1],
  ]}
  xExtent={[-2.75, 2.75]}
  yExtent={[-1.75, 1.75]}
/>

Warum sich die komplexen Exponentialfunktionen als Rotationen verstehen lassen, sollte aus dem Abschnitt [_komplexe Exponentialfunktion_](../appendix/complex-numbers/2-complex-exponentials) bekannt sein.
Zudem sollte die Addition als Vektoraddition bekannt sein. Die Vektoren der einzelnen komplexen Zahlen bzw. komplexen Exponentialfunktionen, werden im Folgenden auch als **Zeiger** bezeichnet.

Die obige Darstellungsweise ist wom√∂glich etwas ungewohnt, da die Funktionswerte alleine dargestellt werden und nicht etwa in Abh√§ngigkeit der Funktionseingaben ($t$). Aus diesem Grund bewegen sich **reelle Funktionswerten** lediglich in einer Dimension.

Wenn man die Werte der **Realteil** Achse jedoch gegen die Zeit auftragen w√ºrde, w√ºrde man eine harmonische Schwingung erkennen. Es handelt sich um $f(t) = \sin (\frac{2 \pi}{T} t)$, da f√ºr die Koeffizienten√ºbersetzung $c_k = \frac{1}{2}(a_k-b_k i)$ gilt und somit mit $c_1 = 0.5$

$$
1 = a_1-b_1 i \Leftrightarrow a_1 = 1
$$

Mit $a_1 = 1$ und

$$
f(t) = \frac{a_0}{2} + \sum_{k=1}^n a_k \sin \left(\frac{2 \pi k}{T} t\right)+ b_k \cos \left(\frac{2 \pi k}{T} t \right)
$$

folgt also $f(t) = \sin(\frac{2 \pi}{T} t)$.

### Begr√ºndung reeller Funktionswerte

Durch die Eigenschaft der **komplexen konjugierten Koeffizienten** wird garantiert, dass es nur **reelle Funktionswerte** gibt. Dies wurde bereits im Abschnitt [_Periodische Funktionen_](./1-periodic-functions) durch das Umformen der Summe

$$
\begin{equation}
f(t) = \frac{a_0}{2} + \sum_{k=1}^n a_k \sin \left(\frac{2 \pi k}{T} t\right)+ b_k \cos \left(\frac{2 \pi k}{T} t \right)
\end{equation}
$$

welche ausschlie√ülich **reele Funktionswerte** erzeugt, in die Summe

$$
\begin{equation}
f(t) = \sum_{k=-n}^n c_k e^{\frac{2 \pi i k}{T} t }
\end{equation}
$$

mit der Koeffizienten√ºbersetzung

$$
c_k =
\begin{cases}
\frac{1}{2}(a_k - b_k i) &  \text{ wenn } k > 0 \\
\frac{a_0}{2} & \text{ wenn } k = 0 \\
\overline{c}_{-k} & \text{ wenn } k < 0\\
\end{cases}
$$

gezeigt. Es wurde gezeigt, dass die beiden Summenausdr√ºcke ($(1)$ und $(2)$) √§quivalent sind, insofern die Koeffizienten richtig √ºbersetzt werden.
Somit muss immer wenn die Eigenschaft gilt, dass $c_k = \overline{c}_{-k}$ f√ºr $k <0$ folgen, dass es ausschlie√ülich **reelle Funktionswerte** gibt, da sich $(2)$ in
$(1)$ √ºbersetzen lie√üe.

Berechtigterweise kann man sich die Frage stellen, was passiert, wenn die Bedingung: $c_k = \overline{c}_{-k}$ f√ºr $k <0$, nicht erf√ºllt ist.
Um folgende Formulierungen und Folgerungen allgemeiner gestalten zu k√∂nnen und somit auch komplexe Funktionswerte zuzulassen, wird der Ausdruck $(2)$ ohne die Bedingung betrachet.
Somit befinden sich die Ausgaben nicht unbedigt ausschlie√ülich auf der _Realteil-Achse_.

Die Eigenschaft der **konjugierten komplexen Zahlen** l√§sst sich auch visuell darstellen und verstehen. In der folgenden Darstellung l√§sst sich die Summe der Terme $c_{-1} \cdot e^{- \frac{2 \pi }{T} t}$ und $c_{1} \cdot e^{- \frac{2 \pi }{T} t}$ mit der Eigenschaft von **konjugierten komplexen Zahlen** betrachten.

<ComplexConjugates />

Dadurch, jeweils die Koeffizienten $c_k$ und $c_{-k}$ in der obigen Summe $(2)$, jeweils **konjugierte komplexe Zahlen sind** rotieren die beiden Zeiger, welche sich mit der gleichen Frequenz ($\frac{k}{T}$) jedoch durch das negative Vorzeichen in unterschiedliche Richtungen drehen, **achsensymmetrisch** zur _Realteil-Achse_. Dies wird dadurch verursacht, dass die Startposition der Zeiger durch die **konjugierten komplexen Zahlen** $c_k$ und $c_{-k}$ festgelegt werden (**konjugierte komplexe Zahlen** sind liegen immer achsensymmetrisch zur _Realteil-Achse_).

Dadurch kommt es also zustande, dass nur **reelle Zahlen** entstehen, wenn die Eigenschaft $c_{-k} = \overline{c_k}$ gegeben ist.

## Ermittlung der Koeffizienten

Es ist zwar noch nicht klar, ob es m√∂glich ist jede periodische Funktion mit der obigen Summe zu modellieren.
Im Folgenden wird jedoch betrachtet, was f√ºr die Koeffizienten $c_k$ folgen w√ºrde, wenn es so w√§re.
Wenn also gelten w√ºrde:

$$
f(t) = \sum_{k=-n}^n c_k e^{\frac{2 \pi i k}{T} t }
$$

Wie m√ºssten dann die Koeffizienten $c_k$ in Abh√§ngigkeit von $f(t)$ gew√§hlt werden?

Dabei wird jedoch auch zugelassen, dass $f(t) \in \mathbb{C}$ und somit die Eigenschaft $c_{-k} = \overline{c_k}$ nicht gegeben ist.
Man bestimme also die Koeffizienten $c_k$ mit $k<0$ unabh√§ngig von $c_k$ mit $k>0$.

Das Einzige, was bekannt ist, ist die Funktion $f(t)$ (in welcher Form das genau der Fall ist wird sp√§ter relevant), und die Periodendauer der Funktion $f$. Also $T$ mit $f(t) = f(t+T)$ f√ºr alle $t \in \mathbb{R}$.

### √úberlegung mithilfe von durchschnittlichen Funktionswerten

Zun√§chst l√§sst sich zum Beispiel √ºberlegen, wie der _einfachste_ Koeffizient $c_0$ gew√§hlt werden m√ºsste.
Dieser entspricht wie zuvor herausgestellt, einer Verschiebung.
Das liegt daran, dass $c_0$ mit $e^{\frac{2 \pi i \cdot 0}{T} t} = 1$ multipliziert wird. Wenn man also die Ergebnisse der Summe auf der komplexen Ebene betrachtet, entspricht der $c_0$ Koeffizient einer konstanten Verschiebung vom Ursprung.

Im Folgenden ist das Ergebnis der Summe $(1)$ mit $c_0 = 2+i$, $c_1 = 2$ und $c_2 = i$ dargestellt. Der Rest der Koeffizienten ist $0$.

<ComplexExpoentialsSum
  ak={[
    [2, 1, 0],
    [2, 0, 1],
    [0, 1, 2],
  ]}
/>

<QuestionAnswer>
  <>
    Wo liegt der durchschnittliche Wert der obigen Funktion, wenn man eine
    Periode der gesamten Schwingung betrachet?
  </>
  <Answer>Bei $0$</Answer>
  <Answer>Bei $1+i$</Answer>
  <Answer correct={true}>Bei $2+i$</Answer>
  <Answer>Man kann keine Aussage dar√ºber treffen</Answer>
</QuestionAnswer>

Eine Herangehensweise zu obiger Frage k√∂nnte √ºber die durchschnittlichen Werte der einzelnen Schwingungsbeitr√§ge sein.
Da alle Schwingungsbeitr√§ge per Definition der Summe, eine Frequenz haben, welche einem ganzzahliges Vielfachen der **Grundfrequenz** (Frequenz der gesamten Schwingung) entspricht, muss jeder **rotierende Zeiger** eine ganzzahlige Anzahl an Rotationen vollf√ºhren.

Wenn man nun einen Zeiger separat betrachtet und dieser eine ganzzahlige Anzahl an Malen um den Urpsrung rotiert, dann muss dieser Zeiger logischerweise einen durchschnittlichen Wert von $0$ haben.

Da dies f√ºr jeden Zeiger gilt, welcher eine ganzzahlige Anzahl an Malen in der Zeit einer Periode rotiert, h√§ngt der durchschnittliche Funktionswert nur von jenen Zeigern ab, welche nicht rotieren.
Da nur der Zeiger, welcher aus dem Term $c_0 \cdot e^{0} = c_0$ resultiert, nicht rotiert, ist somit der durchschnittliche Funktionswert nur von $c_0$ abh√§ngig. Der durchschnittliche Funktionswert entspricht also dadurch, dass $c_0$ konstant ist, $c_0$.

**Was bringt das nun?** Wenn der durchschnittliche Funktionswert in einer Periode genau $c_0$ entspricht, dann lie√üe sich $c_0$ bestimmen, wenn $f(t)$ un die Periodendauer $T$ bekannt sind. Man berechne also mithilfe den durchschnittlichen Funktionswert einer bekannten Funktion $f(t)$ innerhalb einer Zeitspanne von $T$.

Somit lie√üe sich schonmal der Koeffizient $c_0$ bestimmen. Man ist also dem Ziel, alle Koeffizienten der Summendarstellung zu bestimmen, um $f(t)$ anders auszudr√ºcken, etwas n√§her.

### Bestimmung von durchschnittlichen Funktionswerten

Um den durchschnittlichen Funktionswert einer Funktion √ºber eine Periode zu bestimmen folgt:

$$
c_0 = \frac{1}{T} \int_0^{T} f(t) dt
$$

<Callout>
  F√ºr den durchschnittlichen Funktionswert $\overline{y}$ einer Funktion $f(x)$
  in einem Intervall $[a,b]$ gilt: 
  $$
  \begin{equation*}
  \overline{y} = \frac{1}{b - a} \int_a^{b} f(x) dx 
  \end{equation*}
  $$
  Das Integral kann hierbei als eine Art Summierung aller Funktionswerte verstanden werden.
  Wenn man den Durchschnitt (bzw. arithmetischen Mittelwert) $\overline{a}$ einer diskreten (d.h. abz√§hlbaren Gr√∂√üe) berechnet, gilt der Zusammenhang:
  $$
  \overline{a} = \frac{1}{n} \sum_{k=1}^n a_k
  $$
  wobei $n$ der Anzahl an Werten entspricht.
  Wenn es sich nun um Funktionswerte handelt, welche nicht diskret, sondern kontinuierlich vorliegen, wird die diskrete Summe zu einem kontinuierlichen Integral.
</Callout>

### Verallgemeinerung des Verfahrens auf alle Koeffizienten

Die obige [Idee](#√ºberlegung-mithilfe-von-durchschnittlichen-funktionswerten), den durchschnittlichen Funktionswert auszunutzen, um den Wert eines Koeffizienten zu bestimmen, welcher zur konstanten Verschiebung geh√∂rt, l√§sst sich tats√§chlich f√ºr alle Koeffizienten anwenden.

Man k√∂nnte versuchen jeweils einen spezifischen rotierenden Zeiger, zu einem Zeiger zu ver√§ndern, welcher f√ºr eine konstante Verschiebung sorgt. Dabei m√ºssen jedoch alle anderen Zeiger eine ganzzahlige Anzahl an Malen um den Urpsrung rotieren.

Um einen spezifischen Koeffizienten $c_m$ herauszufinden, probiert man also die Funktion $f(t)$ und die Summe $(2)$ so zu manipulieren, dass genau der Zeiger $m$ _stehen bleibt_
und somit _alleinig_ den durchschnittlichen Funktionswert der manipulierten Funktion beeinflusst. Folgend k√∂nnte man $c_m$ analog zu $c_0$ ermitteln.

Hier nochmal der Summenausdruck:

$$
f(t) = \sum_{k=-n}^n c_k e^{\frac{2 \pi i k}{T} t }
$$

<QuestionAnswer>
  <>Wie k√∂nnte man die oben beschriebene *Manipulation* erreichen (f√ºr $c_m$)?</>
  <Answer>Multiplikation mit $e^{\frac{2 \pi i m}{T}t}$</Answer>
  <Answer correct={true}>Multiplikation mit $e^{-\frac{2 \pi i m}{T}t}$</Answer>
  <Answer>Multiplikation mit $c_k$</Answer>
  <Answer>Multiplikation mit $-c_k$</Answer>
  <Answer>Es ist nicht m√∂glich</Answer>
</QuestionAnswer>

### Algebraischer Ansatz

F√ºr die Ermittlung einer gesuchten Variable, lernt man, dass man diese Variable auf einer Seite der Gleichung isolieren soll.
Wenn also beispielsweise ein Koeffizient $c_m$ ($-n\leq m\leq n$) gesucht ist, folgt mit algebraischen Umformungen:

$$
\begin{equation*}
\begin{split}
\sum_{k=-n}^n c_k e^{2 \pi i k\frac{1}{T} t } &= f(t) \\
c_m e^{2 \pi i m\frac{1}{T}t}+ \sum_{\substack{k=-n \\ k\neq m}}^n c_k e^{2 \pi i k\frac{1}{T}t} &= f(t) \qquad | -\sum_{\substack{k=-n \\ k\neq m}}^n c_k e^{2 \pi i k\frac{1}{T}t}\\
c_m e^{2 \pi i m\frac{1}{T}t} & = f(t) - \sum_{\substack{k=-n \\ k\neq m}}^n c_k e^{2 \pi i k\frac{1}{T}t} \qquad | \cdot e^{-2 \pi i m\frac{1}{T}t}\\
c_m & = f(t) \cdot e^{-2 \pi i m\frac{1}{T}t} - \sum_{\substack{k=-n \\ k\neq m}}^n c_k e^{2 \pi i k\frac{1}{T}t} \cdot e^{-2 \pi i m\frac{1}{T}t}\\
c_m & = f(t) \cdot e^{-2 \pi i m\frac{1}{T}t} - \sum_{\substack{k=-n \\ k\neq m}}^n c_k e^{2 \pi i (k-m)\frac{1}{T}t}\\
\end{split}
\end{equation*}
$$
